<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Casper</title>
    <link rel="icon" href="img/favicon.png" type="image/png">
    <link rel="stylesheet" href="styles/rulebot.css">
    <link rel="stylesheet" href="styles/icons.css">
    <!-- <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet"> -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'> -->
    <link rel="stylesheet" href="styles/animations.css">
    <link rel="stylesheet" href="styles/transformations.css">
    <link href='styles/boxicon/boxicons.css' rel='stylesheet'>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&display=swap" rel="stylesheet">
</head>
<body>
    <div class="overlay" id="overlay">
        <div class="confirm-dialog" id="confirm-dialog">
            <h3 class="confirm-dialog-title">Titolo</h3>
              <p class="confirm-dialog-description">Descrizione</p>
              <div class="confirm-buttons">
                  <button class="confirm-btn no">No</button>
                  <button class="confirm-btn yes">Si</button>
                  <button class="confirm-btn ok">Ok</button>
              </div>
        </div>
    </div>
    <div class="container">
        <div class="chat-container">
            
            <div id="left-container">
                <div id="rules-head">
                    <div id="welcome">                        
                        <div id="initial-name"></div>
                    </div>

                    <div id="rules-buttons-container">
                        <div type="button" id="show-rules" class="selector-button selector-selected"><i class='bx bxs-magic-wand' ></i> Automazioni <span class="circle-number" id="n_automations"></span></div>
                        <div type="button" id="show-devices" class="selector-button selector-unselected"><i class='bx bxs-washer'></i> Dispositivi <span class="circle-number" id="n_devices"></span></div>
                        <div type="button" id="show-problems" class="selector-button selector-unselected"><i class='bx bx-alarm-exclamation'></i> Problemi <span class="circle-number" id="n_problems"></span></div>
                        <div type="button" id="show-goal-adv" class="selector-button selector-unselected"><i class='bx bx-crosshair'></i> Ottimizza <span class="circle-number" id="n_goal_advisor"></span></div>
                        <div type="button" id="show-preferences" class="selector-button selector-unselected"><i class='bx bx-cog'></i> Preferenze </span></div>
                    </div>
                </div>
                
                <div id="rules-container" class="leftbar-selected">
                </div>

                <div id="devices-list-container" class="leftbar-unselected"> 
                </div>

                <div id="problems-main-container" class="leftbar-unselected">
                    <div class="loader-container" style="display: none;">
                        <div class="loader"></div>
                    </div>
                    <div class="carousel-wrapper">
                        <div id="carousel-messages">
                        
                        </div>
                        <div id="carousel-controls" class="carousel-controls" style="display: none;">
                            <button class="control-btn" id="prevBtn">‚Äπ</button>
                            <button class="control-btn" id="nextBtn">‚Ä∫</button>
                        </div>
                        
                        <div class="carousel" id="carouselTrack">    
                            
                        </div>
                    
                    </div>     
                </div>

                <div id="goal-adv-container" class="leftbar-unselected">
                    <div class="automation-list-wrapper">
                        <div class="problem-goal-container">

                            <div class="overview-panel">

                                    <div class="goals-container">

                                        <div class="goal-item-overview">
                                            <div class="goal-score">
                                                <div class="circular-progress">
                                                    <svg viewBox="0 0 40 40">
                                                        <circle cx="20" cy="20" r="18" class="bg-circle"></circle>
                                                        <circle cx="20" cy="20" r="18" class="progress-circle" 
                                                                style="stroke-dashoffset: 17.0;"></circle>
                                                    </svg>
                                                    <div class="progress-text">85%</div>
                                                </div>
                                            </div>
                                            <div class="goal-info">
                                                <div class="goal-icon">üå±</div>
                                                <div class="goal-name">Benessere</div>
                                            </div>
                                        </div>

                                        <div class="goal-item-overview">
                                            <div class="goal-score">
                                                <div class="circular-progress">
                                                    <svg viewBox="0 0 40 40">
                                                        <circle cx="20" cy="20" r="18" class="bg-circle"></circle>
                                                        <circle cx="20" cy="20" r="18" class="progress-circle" 
                                                                style="stroke-dashoffset: 17.0;"></circle>
                                                    </svg>
                                                    <div class="progress-text">85%</div>
                                                </div>
                                            </div>
                                            <div class="goal-info">
                                                <div class="goal-icon">üîã</div>
                                                <div class="goal-name">Risparmio <br> Energetico</div>
                                            </div>
                                        </div>

                                        <div class="goal-item-overview">
                                            <div class="goal-score">
                                                <div class="circular-progress">
                                                    <svg viewBox="0 0 40 40">
                                                        <circle cx="20" cy="20" r="18" class="bg-circle"></circle>
                                                        <circle cx="20" cy="20" r="18" class="progress-circle" 
                                                                style="stroke-dashoffset: 17.0;"></circle>
                                                    </svg>
                                                    <div class="progress-text">85%</div>
                                                </div>
                                            </div>
                                            <div class="goal-info">
                                                <div class="goal-icon">‚ù§Ô∏è</div>
                                                <div class="goal-name">Salute</div>
                                            </div>
                                        </div>

                                        <div class="goal-item-overview">
                                            <div class="goal-score">
                                                <div class="circular-progress">
                                                    <svg viewBox="0 0 40 40">
                                                        <circle cx="20" cy="20" r="18" class="bg-circle"></circle>
                                                        <circle cx="20" cy="20" r="18" class="progress-circle" 
                                                                style="stroke-dashoffset: 17.0;"></circle>
                                                    </svg>
                                                    <div class="progress-text">85%</div>
                                                </div>
                                            </div>
                                            <div class="goal-info">
                                                <div class="goal-icon">üõ°Ô∏è</div>
                                                <div class="goal-name">Sicurezza</div>
                                            </div>
                                        </div>

                                       
                                    </div>

                            </div>

                            <div class="automation-card problem-goal-card" style="display: block;" onclick="toggleCardExpansion(this)">
                    
                                <div class="card-header">
                                    <div style="display: flex; align-items: center; float: right;">
                                        <div class="automation-icon kitchen-icon">‚ö°</div>
                                        <div>
                                            <div class="automation-title">Accendi luce ripostiglio</div>
                                            <div class="automation-id">ID 1750851243473</div>
                                        </div>
                                    </div>
                                    <div style="float: left;">
                                        <span class="goal-tag">üîã Risparmio Energetico</span>
                                    
                                        <span class="severity-badge severity-high">Alta</span>
                                    </div>                     
                                
                                </div>
                                <div class="automation-description">Questa automazione non ha una descrizione</div>
                                
                                <div class="expand-button">
                                    <i class="expand-icon"></i>
                                </div>
                            </div>
                            <div class="problem-goal-explanation-container">
                                <div class="problem-goal-explanation" display="none">
                                    <div class="expanded-section">
                                        Spiegazione del problema... Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean volutpat odio non neque egestas tristique. Vestibulum pellentesque ligula at elementum ultricies. Fusce feugiat ligula nibh, sit amet euismod mauris hendrerit id. Duis vel metus blandit, placerat eros id, euismod diam. Nunc at eros sed magna faucibus aliquam.
                                        <p class="card-title">Come posso risolvere?</p>
                                        <div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioDefault" id="radioDefault0-0">
                                                <label class="form-check-label" for="radioDefault0-0">Ogni giorno alle 08:59, spegni la presa del condizionatore.</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioDefault">
                                                <label class="form-check-label" for="radioDefault0-1">Ogni giorno alle 09:00, se la presa del condizionatore √® accesa, spegnila.</label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="expanded-actions action-buttons">
                                        
                                        <button class="btn btn-ignore" id="1750933449751_1750933449750_switch.shellyplug_55d77d" problemid="1">Ignora</button>
                                        <button class="btn btn-resolve" id="1750933449751_1750933449750_switch.shellyplug_55d77d" problemid="1">Risolvi</button>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="problem-goal-container">
                            <div class="automation-card problem-goal-card" style="display: block;" onclick="toggleCardExpansion(this)">
                    
                                <div class="card-header">
                                    <div style="display: flex; align-items: center; float: right;">
                                        <div class="automation-icon kitchen-icon">‚ö°</div>
                                        <div>
                                            <div class="automation-title">Accendi luce ripostiglio</div>
                                            <div class="automation-id">ID 1750851243473</div>
                                        </div>
                                    </div>
                                    <div style="float: left;">
                                        <span class="goal-tag">üõ°Ô∏è Sicurezza</span>
                                    
                                        <span class="severity-badge severity-critical">Critico</span>
                                    </div>                     
                                
                                </div>
                                <div class="automation-description">Questa automazione non ha una descrizione</div>
                                
                                <div class="expand-button">
                                    <i class="expand-icon"></i>
                                </div>
                            </div>
                            <div class="problem-goal-explanation-container">
                                <div class="problem-goal-explanation" display="none">
                                    <div class="expanded-section">
                                        Spiegazione del problema... Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean volutpat odio non neque egestas tristique. Vestibulum pellentesque ligula at elementum ultricies. Fusce feugiat ligula nibh, sit amet euismod mauris hendrerit id. Duis vel metus blandit, placerat eros id, euismod diam. Nunc at eros sed magna faucibus aliquam.                                        <p class="card-title">Come posso risolvere?</p>
                                        <div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioDefault" id="radioDefault0-0">
                                                <label class="form-check-label" for="radioDefault0-0">Ogni giorno alle 08:59, spegni la presa del condizionatore.</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioDefault">
                                                <label class="form-check-label" for="radioDefault0-1">Ogni giorno alle 09:00, se la presa del condizionatore √® accesa, spegnila.</label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="expanded-actions action-buttons">
                                        
                                        <button class="btn btn-ignore" id="1750933449751_1750933449750_switch.shellyplug_55d77d" problemid="1">Ignora</button>
                                        <button class="btn btn-resolve" id="1750933449751_1750933449750_switch.shellyplug_55d77d" problemid="1">Risolvi</button>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="problem-goal-container">
                            <div class="automation-card problem-goal-card" style="display: block;" onclick="toggleCardExpansion(this)">
                    
                                <div class="card-header">
                                    <div style="display: flex; align-items: center; float: right;">
                                        <div class="automation-icon kitchen-icon">‚ö°</div>
                                        <div>
                                            <div class="automation-title">Accendi luce ripostiglio</div>
                                            <div class="automation-id">ID 1750851243473</div>
                                        </div>
                                    </div>
                                    <div style="float: left;">
                                        <span class="goal-tag">üå± Benessere</span>
                                    
                                        <span class="severity-badge severity-medium">Medio</span>
                                    </div>                     
                                
                                </div>
                                <div class="automation-description">Questa automazione non ha una descrizione</div>
                                
                                <div class="expand-button">
                                    <i class="expand-icon"></i>
                                </div>
                            </div>
                            <div class="problem-goal-explanation-container">
                                <div class="problem-goal-explanation" display="none">
                                    <div class="expanded-section">
                                        Spiegazione del problema... Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean volutpat odio non neque egestas tristique. Vestibulum pellentesque ligula at elementum ultricies. Fusce feugiat ligula nibh, sit amet euismod mauris hendrerit id. Duis vel metus blandit, placerat eros id, euismod diam. Nunc at eros sed magna faucibus aliquam. 
                                        <p class="card-title">Come posso risolvere?</p>
                                        <div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioDefault" id="radioDefault0-0">
                                                <label class="form-check-label" for="radioDefault0-0">Ogni giorno alle 08:59, spegni la presa del condizionatore.</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioDefault">
                                                <label class="form-check-label" for="radioDefault0-1">Ogni giorno alle 09:00, se la presa del condizionatore √® accesa, spegnila.</label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="expanded-actions action-buttons">
                                        
                                        <button class="btn btn-ignore" id="1750933449751_1750933449750_switch.shellyplug_55d77d" problemid="1">Ignora</button>
                                        <button class="btn btn-resolve" id="1750933449751_1750933449750_switch.shellyplug_55d77d" problemid="1">Risolvi</button>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="problem-goal-container">
                            <div class="automation-card problem-goal-card" style="display: block;" onclick="toggleCardExpansion(this)">
                    
                                <div class="card-header">
                                    <div style="display: flex; align-items: center; float: right;">
                                        <div class="automation-icon kitchen-icon">‚ö°</div>
                                        <div>
                                            <div class="automation-title">Accendi luce ripostiglio</div>
                                            <div class="automation-id">ID 1750851243473</div>
                                        </div>
                                    </div>
                                    <div style="float: left;">
                                        <span class="goal-tag">‚ù§Ô∏è Salute</span>
                                    
                                        <span class="severity-badge severity-low">Basso</span>
                                    </div>                     
                                
                                </div>
                                <div class="automation-description">Questa automazione non ha una descrizione</div>
                                
                                <div class="expand-button">
                                    <i class="expand-icon"></i>
                                </div>
                            </div>
                            <div class="problem-goal-explanation-container">
                                <div class="problem-goal-explanation" display="none">
                                    <div class="expanded-section">
                                        Spiegazione del problema... Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean volutpat odio non neque egestas tristique. Vestibulum pellentesque ligula at elementum ultricies. Fusce feugiat ligula nibh, sit amet euismod mauris hendrerit id. Duis vel metus blandit, placerat eros id, euismod diam. Nunc at eros sed magna faucibus aliquam.                                        <p class="card-title">Come posso risolvere?</p>
                                        <div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioDefault" id="radioDefault0-0">
                                                <label class="form-check-label" for="radioDefault0-0">Ogni giorno alle 08:59, spegni la presa del condizionatore.</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="radioDefault">
                                                <label class="form-check-label" for="radioDefault0-1">Ogni giorno alle 09:00, se la presa del condizionatore √® accesa, spegnila.</label>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="expanded-actions action-buttons">
                                        
                                        <button class="btn btn-ignore" id="1750933449751_1750933449750_switch.shellyplug_55d77d" problemid="1">Ignora</button>
                                        <button class="btn btn-resolve" id="1750933449751_1750933449750_switch.shellyplug_55d77d" problemid="1">Risolvi</button>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            

                <div id="preferences-container" class="leftbar-unselected">
                    
                </div>  
                
            </div>
            <div id="chat">
                <!-- <div class="chat-container-cover">Chat</div> -->
                
                    <div class="chat-header">
                        <div id="logo">
                            <svg style="width:60px" xmlns="http://www.w3.org/2000/svg" viewBox="-1.5 -13.125 11 12.63">
                                <defs>
                                    <linearGradient id="myGradient" x1="0%" y1="0%" x2="100%" y2="0%" gradientUnits="userSpaceOnUse">
                                        <stop offset="0%" stop-color="#0066FF">
                                            <animate attributeName="stop-color" 
                                                    values="#0066FF;#00FF88;#8B5CF6;#0066FF"
                                                    dur="8s" 
                                                    repeatCount="indefinite"/>
                                            <animate attributeName="stop-opacity" 
                                                    values="1;0.85;1"
                                                    dur="4s" 
                                                    repeatCount="indefinite"/>
                                        </stop>
                                        <stop offset="40%" stop-color="#00FF88">
                                            <animate attributeName="stop-color" 
                                                    values="#00FF88;#8B5CF6;#0066FF;#00FF88"
                                                    dur="8s" 
                                                    repeatCount="indefinite"/>
                                            <animate attributeName="stop-opacity" 
                                                    values="0.85;1;0.85"
                                                    dur="5s" 
                                                    repeatCount="indefinite"/>
                                        </stop>
                                        <stop offset="70%" stop-color="#8B5CF6">
                                            <animate attributeName="stop-color" 
                                                    values="#8B5CF6;#0066FF;#00FF88;#8B5CF6"
                                                    dur="8s" 
                                                    repeatCount="indefinite"/>
                                            <animate attributeName="stop-opacity" 
                                                    values="1;0.85;1"
                                                    dur="5s" 
                                                    repeatCount="indefinite"/>
                                        </stop>
                                    </linearGradient>
                                    <clipPath id="housePath">
                                        <path d="M 0 0 L 8 0 C 9 0 9 -1 9 -1 C 9 -1 9 -1 9 -1 V -8 Q 9 -9 8 -10 C 3 -14 5 -14 0 -10 Q -1 -9 -1 -8 V -1 Q -1 0 0 0"/>
                                    </clipPath>
                                </defs>
                                <image 
                                    href="img/favicon.png" 
                                    x="-0.5" 
                                    y="-11.2" 
                                    width="9" 
                                    clip-path="url(#housePath)"
                                    preserveAspectRatio="xMidYMid slice"/>

                                <path d="M 0 -1 L 7.998 -1.022 Q 9 -1 9 -2 V -8 Q 9 -9 8 -10 C 3.022 -13.5 5 -13.5 0 -10 Q -1 -9 -1 -8 V -2.06 Q -1 -1 0 -1"
                                    stroke="url(#myGradient)" 
                                    stroke-width="0.5" 
                                    fill="none"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"/>
            
                            </svg>
                            <div class="agent-info">
                                <div class="agent-name">CASPER</div>
                                <div class="status-indicator-chat inactive"></div>
                                <div class="agent-status"></div>
                            </div>
                        </div>
                        <div class="chat-controls">
                            <div class="toggle-container">
                                <div class="toggle-switch-theme dark" id="toggleSwitch" style="transition: all 0.3s ease;">
                                    <div class="toggle-bg-icons sun-bg">‚òÄÔ∏è</div>
                                    <div class="toggle-bg-icons moon-bg"><img width="23" height="23" src="https://img.icons8.com/retro/32/crescent-moon.png" alt="crescent-moon"/></div>
                                    <div class="toggle-ball dark" id="toggleBall">
                                        <span class="sun-icon">‚òÄÔ∏è</span>
                                        <span class="moon-icon"><img width="23" height="23" src="https://img.icons8.com/retro/32/crescent-moon.png" alt="crescent-moon"/></span>
                                    </div>
                                </div>
                            </div>
                            <div class="reset-btn tooltip" id="reset">
                                <svg class="reset-icon" viewBox="0 0 24 24">
                                    <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4c-4.42,0 -7.99,3.58 -7.99,8s3.57,8 7.99,8c3.73,0 6.84,-2.55 7.73,-6h-2.08c-0.82,2.33 -3.04,4 -5.65,4 -3.31,0 -6,-2.69 -6,-6s2.69,-6 6,-6c1.66,0 3.14,0.69 4.22,1.78L13,11h7V4L17.65,6.35z"></path>
                                </svg>
                            </div>
                            <div class="control-btn logout-btn" id="logout">üö™ Logout</div>
                        </div>    
                    </div>
                    <div id="msgContainer">
                    </div>
                    <div id="inputContainer">
                        <textarea id="inputBox" name="inputBox" placeholder="Inserisci qua il tuo input..."></textarea>
                        <button id="send" class="inputButton send"><img class="buttonIcon" src="icons/send.png" alt=""></button>
                    </div>
                
            </div>
        </div>
        <div id="right-container">
            <div id="token-info">
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
    <script src="scripts/jwt-decode.js"></script>
    <script src="https://requirejs.org/docs/release/2.3.6/minified/require.js"></script>
    <script src="scripts/icons-map.js"></script>
    <script src="scripts/rulebot.js"></script>
</body>
</html>